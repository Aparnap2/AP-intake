# Production Environment Configuration Template
# AP Intake & Validation System
# SECURITY: Replace all placeholder values with actual production secrets

# ===================================================================
# CRITICAL SECURITY CONFIGURATION
# ===================================================================

# Application Secret Key - MUST be changed in production
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(64))"
SECRET_KEY=your-super-secret-key-here-must-be-64-characters-minimum

# Database Configuration - Use strong passwords
DATABASE_URL=postgresql+asyncpg://username:strong_password@db-host:5432/ap_intake_prod
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=30
DATABASE_POOL_TIMEOUT=30
DATABASE_POOL_RECYCLE=3600

# Redis Configuration
REDIS_URL=redis://username:password@redis-host:6379/0

# Message Queue - Use secure credentials
RABBITMQ_URL=amqp://username:password@rabbitmq-host:5672/ap_intake_vhost

# ===================================================================
# EXTERNAL SERVICE CONFIGURATION
# ===================================================================

# OpenRouter LLM Service
OPENROUTER_API_KEY=sk-or-your-openrouter-api-key
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1
LLM_MODEL=z-ai/glm-4.5-air:free
LLM_MAX_TOKENS=1000
LLM_TEMPERATURE=0.1
OPENROUTER_APP_NAME=AP Intake & Validation
OPENROUTER_APP_URL=https://your-domain.com

# LLM Cost Controls
OPENROUTER_DAILY_LIMIT=100.0
OPENROUTER_MONTHLY_LIMIT=2000.0
OPENROUTER_ALERT_THRESHOLDS=0.5,0.8,0.95

# Gmail API Configuration
GMAIL_CLIENT_ID=your-gmail-oauth2-client-id
GMAIL_CLIENT_SECRET=your-gmail-oauth2-client-secret
GMAIL_REDIRECT_URI=https://your-domain.com/api/v1/auth/gmail/callback

# QuickBooks Configuration - PRODUCTION CREDENTIALS REQUIRED
QUICKBOOKS_CLIENT_ID=your-quickbooks-production-client-id
QUICKBOOKS_CLIENT_SECRET=your-quickbooks-production-client-secret
QUICKBOOKS_REDIRECT_URI=https://your-domain.com/api/v1/quickbooks/callback
QUICKBOOKS_ENVIRONMENT=production

# QuickBooks Webhook Security
QUICKBOOKS_WEBHOOK_SECRET=your-quickbooks-webhook-verifier-token

# ===================================================================
# STORAGE CONFIGURATION
# ===================================================================

# AWS S3 Configuration
STORAGE_TYPE=s3
AWS_ACCESS_KEY_ID=your-aws-access-key
AWS_SECRET_ACCESS_KEY=your-aws-secret-key
AWS_REGION=us-east-1
S3_BUCKET_NAME=ap-intake-documents-prod
S3_ENDPOINT_URL=  # Leave empty for AWS S3, fill for S3-compatible services

# Storage Security
STORAGE_ENCRYPTION_ENABLED=true
STORAGE_INTEGRITY_CHECKS_ENABLED=true
STORAGE_ACCESS_LOGGING_ENABLED=true

# ===================================================================
# SECURITY CONFIGURATION
# ===================================================================

# Security Settings
ENVIRONMENT=production
DEBUG=false
REQUIRE_HTTPS=true
ALLOWED_HOSTS=your-domain.com,www.your-domain.com
CORS_ORIGINS=https://your-domain.com,https://www.your-domain.com

# Session Security
SESSION_TIMEOUT_MINUTES=30
MAX_LOGIN_ATTEMPTS=5
LOCKOUT_DURATION_MINUTES=15

# API Key Rotation
API_KEY_ROTATION_DAYS=90

# ===================================================================
# MONITORING & OBSERVABILITY
# ===================================================================

# Error Tracking
SENTRY_DSN=https://your-sentry-dsn-here
SENTRY_ENVIRONMENT=production
SENTRY_RELEASE=v1.0.0

# LLM Usage Tracking
LANGFUSE_SECRET_KEY=your-langfuse-secret-key
LANGFUSE_PUBLIC_KEY=your-langfuse-public-key
LANGFUSE_HOST=https://cloud.langfuse.com

# Monitoring
ENABLE_METRICS=true
METRICS_PORT=9090
HEALTH_CHECK_INTERVAL_SECONDS=30
ENABLE_PERFORMANCE_TRACING=true

# Alerting
ALERT_WEBHOOK_URL=https://your-alert-webhook-url
ALERT_EMAIL_RECIPIENTS=admin@your-domain.com,ops@your-domain.com
ENABLE_ALERTING=true

# ===================================================================
# PERFORMANCE & RELIABILITY
# ===================================================================

# Rate Limiting
OPENROUTER_REQUESTS_PER_SECOND=20
OPENROUTER_BURST_CAPACITY=50
GMAIL_REQUESTS_PER_SECOND=100
GMAIL_BURST_CAPACITY=200
QUICKBOOKS_REQUESTS_PER_SECOND=8
QUICKBOOKS_BURST_CAPACITY=20

# Retry Configuration
DEFAULT_RETRY_ATTEMPTS=3
DEFAULT_RETRY_DELAY_SECONDS=1.0
DEFAULT_MAX_DELAY_SECONDS=60.0

# Circuit Breaker Configuration
DEFAULT_FAILURE_THRESHOLD=5
DEFAULT_RECOVERY_TIMEOUT_SECONDS=60
DEFAULT_RECOVERY_TIMEOUT_MAX=300

# Background Processing
WORKER_CONCURRENCY=8
WORKER_PREFETCH_MULTIPLIER=2
WORKER_TASK_SOFT_TIME_LIMIT=300
WORKER_TASK_TIME_LIMIT=600

# ===================================================================
# EMAIL PROCESSING
# ===================================================================

EMAIL_INGESTION_ENABLED=true
EMAIL_MONITORING_INTERVAL_MINUTES=60
EMAIL_MAX_PROCESSING_DAYS=7
EMAIL_AUTO_PROCESS_INVOICES=true
EMAIL_SECURITY_VALIDATION_ENABLED=true

# ===================================================================
# FILE PROCESSING
# ===================================================================

MAX_FILE_SIZE_MB=25
ALLOWED_FILE_TYPES=pdf,jpeg,jpg,png

# Docling Configuration
DOCLING_CONFIDENCE_THRESHOLD=0.85
DOCLING_MAX_PAGES=50
DOCLING_TIMEOUT_SECONDS=30
DOCLING_MAX_CONCURRENT_JOBS=4
DOCLING_MEMORY_LIMIT_MB=2048

# ===================================================================
# LOGGING CONFIGURATION
# ===================================================================

LOG_LEVEL=INFO
LOG_FORMAT=json
ENABLE_STRUCTURED_LOGGING=true

# ===================================================================
# LANGGRAPH CONFIGURATION
# ===================================================================

LANGGRAPH_PERSIST_PATH=./langgraph_storage_prod
LANGGRAPH_STATE_TTL=3600

# ===================================================================
# EXPORT CONFIGURATION
# ===================================================================

EXPORT_PATH=./exports
QUICKBOOKS_SANDBOX_CLIENT_ID=  # REMOVE in production
QUICKBOOKS_SANDBOX_CLIENT_SECRET=  # REMOVE in production
XERO_SANDBOX_CLIENT_ID=your-xero-production-client-id
XERO_SANDBOX_CLIENT_SECRET=your-xero-production-client-secret

# ===================================================================
# ADDITIONAL PRODUCTION SETTINGS
# ===================================================================

# Application
API_V1_STR=/api/v1
PROJECT_NAME=AP Intake & Validation
PROJECT_DESCRIPTION=Transform emailed PDF invoices into validated, structured bills
VERSION=1.0.0

# UI Configuration
UI_HOST=https://your-domain.com
API_HOST=https://api.your-domain.com

# Backup Configuration
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30

# Cache Configuration
CACHE_TTL_SECONDS=3600
CACHE_MAX_SIZE=1000

# SSL/TLS Configuration
SSL_CERT_PATH=/etc/ssl/certs/your-domain.crt
SSL_KEY_PATH=/etc/ssl/private/your-domain.key

# ===================================================================
# DEPLOYMENT SPECIFIC SETTINGS
# ===================================================================

# Container Orchestration (if using Kubernetes/Docker)
KUBERNETES_NAMESPACE=ap-intake-prod
DOCKER_IMAGE_TAG=latest
REPLICAS=3

# Load Balancer
LOAD_BALANCER_TYPE=application
LOAD_BALANCER_SSL_POLICY=ELBSecurityPolicy-TLS-1-2-2017-01

# Autoscaling
MIN_REPLICAS=2
MAX_REPLICAS=10
CPU_TARGET_UTILIZATION=70
MEMORY_TARGET_UTILIZATION=80

# ===================================================================
# COMPLIANCE & AUDIT
# ===================================================================

# GDPR Compliance
DATA_RETENTION_DAYS=365
ANONYMIZATION_ENABLED=true
CONSENT_MANAGEMENT_ENABLED=true

# Audit Logging
AUDIT_LOG_ENABLED=true
AUDIT_LOG_PATH=/var/log/ap-intake/audit.log
AUDIT_EVENTS=login,logout,data_access,api_key_generation,data_export

# ===================================================================
# DEVELOPMENT/OVERRIDE SETTINGS
# ===================================================================
# Note: Do not use these settings in production without proper security review

# DEVELOPER_MODE=false
# SKIP_SSL_VERIFICATION=false
# ENABLE_DEBUG_ENDPOINTS=false
# ALLOW_CORS_ALL_ORIGINS=false